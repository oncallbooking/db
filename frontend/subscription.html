<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Subscriptions — FutriFix</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="container top-inner">
      <div class="brand">FutriFix</div>
      <nav class="navlinks"><a href="/">Home</a></nav>
    </div>
  </header>

  <main class="container subs">
    <h1>Customer Subscription Plans</h1>
    <p class="muted lead">Get priority access to verified technicians with exclusive benefits.</p>

    <div class="plans">
      <div class="plan card">
        <h3>Basic</h3>
        <div class="price">Free</div>
        <ul>
          <li>Standard technician response time</li>
        </ul>
        <button class="btn disabled">Current Plan</button>
      </div>

      <div class="plan card featured">
        <div class="tag">Most Popular</div>
        <h3>Plus</h3>
        <div class="price">₹149 /mo</div>
        <ul><li>Priority technicians</li></ul>
        <button class="btn" onclick="subscribe('plus')">Subscribe Now</button>
      </div>

      <div class="plan card">
        <h3>Elite</h3>
        <div class="price">₹299 /mo</div>
        <ul><li>Unlimited priority technicians</li></ul>
        <button class="btn" onclick="subscribe('elite')">Subscribe Now</button>
      </div>
    </div>

    <div id="subResult" class="note muted"></div>
  </main>

  <script>
    async function subscribe(plan){
      const user = JSON.parse(localStorage.getItem('futrifix_user') || 'null');
      if(!user || user.role !== 'customer'){ if(confirm('You must be logged in as customer. Login now?')) window.location = '/login-customer.html'; return; }
      const res = await fetch('/subscribe', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ email: user.email, plan }) });
      const data = await res.json();
      if(!res.ok){ alert(data.message || 'Subscribe failed'); return; }
      document.getElementById('subResult').textContent = 'Subscribed: ' + plan;
      alert('Subscription active (demo)');
    }
  </script>
</body>
</html>
